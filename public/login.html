<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<title>Login · Student–Teacher Booking</title>
	<link rel="stylesheet" href="/login.css" />
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
</head>
<body>
	<header class="container">
		<div class="img-container">
            <img src="./images/logo.png" alt="Logo" height="60" width="60">
            <h1>Edu-Mentors</h1>
        </div>
		<!-- <h1>Login</h1> -->
		<nav class="nav">
			<a class="btn" href="/index.html">Book</a>
			<a class="btn" href="/landing.html">Courses</a>
			<a class="btn" href="/signup.html">Sign up</a>
		</nav>
	</header>
	<main class="container grid">
		<section class="card">
			<h2>Student Login</h2>
			<form id="student-login">
				<div class="field">
					<label>Email</label>
					<input name="email" type="email" required />
				</div>
				<div class="field">
					<label>Password</label>
					<input name="password" type="password" required />
				</div>
				<button class="btn">Login</button>
				<p class="status" id="student-status"></p>
			</form>
		</section>
		<section class="card">
			<h2>Teacher Login</h2>
			<form id="teacher-login">
				<div class="field">
					<label>Email</label>
					<input name="email" type="email" required />
				</div>
				<div class="field">
					<label>Password</label>
					<input name="password" type="password" required />
				</div>
				<button class="btn">Login</button>
				<p class="status" id="teacher-status"></p>
			</form>
		</section>
	</main>
	<script src="/auth.js" defer></script>
	<script>
		function onSubmit(formId, url, statusId){
			const form = document.getElementById(formId);
			const status = document.getElementById(statusId);
			form.addEventListener('submit', async (e)=>{
				e.preventDefault();
				status.textContent = '';
				const payload = Object.fromEntries(new FormData(form).entries());
				try{
					const res = await fetch(url,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(payload)});
					const data = await res.json();
					if(!res.ok) throw new Error(data.error||'Login failed');
					localStorage.setItem('token', data.token);
					status.style.color = '#4ade80';
					status.textContent = 'Login successful';
					const params = new URLSearchParams(location.search);
					const next = params.get('next') || '/index.html';
					setTimeout(()=> location.replace(next), 500);
				}catch(err){
					status.style.color = '#fca5a5';
					status.textContent = err.message;
				}
			});
		}
		onSubmit('student-login','/api/auth/student/login','student-status');
		onSubmit('teacher-login','/api/auth/teacher/login','teacher-status');
	</script>
</body>
</html>


